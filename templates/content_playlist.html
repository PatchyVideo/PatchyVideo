<!-- saved from url=(0056)file:///C:/Users/Administrator/Desktop/Video%20List.html -->
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/new/common.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/new/Top-navbar.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/new/videolist.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/new/component.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/new/Playlists.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="{{ url_for('static',filename='js/generic.js') }}"></script>
    <script src="{{ url_for('static',filename='js/playlist.js') }}"></script>

    <style type="text/css">
        .operation {
            display: inline;
        }
    </style>
    <style type="text/css">
        body {
            background:none;
        }
        .m_a >ul >div{
            font-size:1.5em;
            color:white;
            animation: neon2 1.5s ease-in-out infinite alternate;
            /*  font-family:Iceland;*/
        }
        .m_a >ul >div:hover{
            animation: neon2 1.5s ease-in-out infinite alternate;
        }

        .m_a >ul >div:hover{
            color:#ffffff;
        }
        a{
            text-decoration:none;
            /*transition: all 0.5s;*/
        }

        @keyframes neon2 {
            from {
                text-shadow: 0 0 10px #fff,
                0 0 20px  #fff,
                0 0 30px  #fff,
                0 0 40px  #228DFF,
                0 0 70px  #228DFF,
                0 0 80px  #228DFF,
                0 0 100px #228DFF,
                0 0 150px #228DFF;
            }
            to {
                text-shadow: 0 0 5px #fff,
                0 0 10px #fff,
                0 0 15px #fff,
                0 0 20px #228DFF,
                0 0 35px #228DFF,
                0 0 40px #228DFF,
                0 0 50px #228DFF,
                0 0 75px #228DFF;
            }
        }



        .fa-close{
        text-decoration: none;
        outline: none;
        background: none;
        border: none;
        color: #265778;
        }
        #addtag{
        vertical-align: bottom;
        }

        #btn input{

        height: 50px;
        background-color: ghostwhite;
        color: #265778;
        outline: none;
        border: 1px solid white;
        font-size: 20px;
        position: absolute;
        left: 40%;
        top: 50%;
        }
        #btn input:hover{
        background-color: ghostwhite;
        }

        #tag{
        width: 1200px;
        height: 923px;
            background:url("/static/img/Patchouli.jpg") no-repeat  ;
            background-size: 117% 100%;
    /*    background-size: 1200px 923px;*/
        box-shadow:  0px 0px 5px crimson;
        /*  padding: 50px;*/
        text-align: center;

        display: none;
        position: absolute;
        top: -90px;
        left: 13%;
        z-index: 100;


        }
        .minibox{

        /*             background-color: rgba(255,255,255,0.5);*/
        display: none;
        height: 100%;
        position: relative;
        z-index: 0;
        top:-30px;
        }


        .Taglist{
        padding-top: 2px;
        /*        margin-bottom: 20px;*/
        /*  height: 400px;*/
        overflow:auto;
        position: relative;
        }
        .Taglist li{
        background-color: rgba(255,255,255,0.5);
        display: inline-block;
        zoom: 1;
        padding: 12px;
        margin-left: 10px;
        text-align: center;
        vertical-align: middle;  cursor: pointer;
        list-style: none;
        border-radius: 50px;

        }
        .Taglist p, p> input{
        display: inline-block;
        font-size:18px;
        line-height: 20px;
        margin: 0px 0px 0px 0px!important;
        }.Taglist i{
        display: inline-block;
        }
        .m_a{
        color: rgba(255, 255, 255, 0.8);
        }
        .m_b{
        color: rgba(255, 255, 255, 0.8);
        position: absolute;
        bottom: 18%;
        left: 38%;
        }
        .m_a div{
        margin-bottom: 10px;
        }
        .item input{
            text-decoration: none;
            outline: none;
            background: none;
            border: none;
        }
        .tag_title{
        position: absolute;
        bottom: 44%;
        color: white;
        left: 42%;
        font-size: 25px;
        z-index:-1;
        }
        /*      .tag_title:nth-child(4){
        opacity: 0;
        }*/
        #save{
        position: relative;
        left: 0px;
        bottom: -800px;
        color: white;
        z-index: 999;
        }
        #close{

        position: relative;
        /*     right: -50px;
        bottom: 40px;*/
        right: -570px;
        top: 20px;
        color: white;
        z-index: 999;
        }

        #close:hover,#save:hover{

        color: cornflowerblue;
        }

        #ipt{
        height: 250px;
        width: 300px;
        font-size: 22px;
        padding-top: 10px;
        padding-left: 10px;
        font-weight: bolder;
        text-rendering: auto;
        outline: none;
        border: none;
        color:  #265778;
        letter-spacing: normal;
        word-spacing: normal;
        text-transform: none;
        text-indent: 0px;
        text-shadow: none;
        display: inline-block;
        text-align: start;

        background-color: rgba(255, 255, 255, 0.3);
        }

        .minibox:before{
        content: "";
            position: absolute;
            width: 100%;
            height: 20%;
            top: 68%;
            left: -23%;
            background: url(/static/img/Patchouli.jpg) no-repeat;
            background-size: 1200px 923px;
            filter: blur(86px);
        z-index: -2;
        }
        .m_bg:before{
        content: "";
        position: absolute;
            width: 100%;
            height: 28%;
            top: -11%;
            left: 25%;
       background: url("/static/img/Patchouli.jpg") no-repeat;
        background-size: 1200px 923px;
        filter: blur(100px);
        z-index: -2;
        }
        .Copyright > li > p {
            color: #A0A;
        }
        .Language > li > p {
            color: #585455;
        }
        .Character > li > p {
            color: #0A0;
        }
        .Author > li > p {
            color: #A00;
        }
        .General > li > p {
            color: #0073ff;
        }
        .Meta > li > p {
            color: #F80;
        }
       #edit_second .tooltip:nth-child(1){
             position: relative;
             top: 0px;
         }
        #edit_second .tooltip:nth-child(2){
            position: relative;
            bottom: -70px;
        }
        .tooltiptext {
            font-size: 18px;
            visibility: hidden;
			
            width: 180px;
            background-color: black;
            color: #fff;
            text-align: center;
            border-radius: 2px;
            padding: 5px 0;
            /* Position the tooltip */
            position: absolute;
            z-index: 99;
            top: 1em;
        }

        .edit{
            width: 15%;
            height: 100px;
            display: block;

        }
        .item_content{
            width: 75%;
        }
        .item_end {
            width: 10%;

            font-size: 30px;

        }
        .edit, .item_content{

            position: relative;

        }
        #edit_first{

            position: relative;
            top: 30%;
            padding-right: 30px;
            display: inline;
        }
        #edit_second,.item_end{
            position: relative;
        }

        .item_end{
            top: -15px;
            right: -15px;
        }
        .item_end i{
            transition: all .6s ease;
        }
        .item_end i:nth-child(3){
            position: absolute;
            bottom: -13px;
            right: 80px;
            font-size: 20px;
        }
        #edit_second i:nth-child(1){
            font-size: 40px;
            color:#808080;
            transition: all .6s ease;
            position: absolute;
            top:-20px
        }
        .video-detail a{
            transition: all .4s ease;
        }

        #edit_second i:nth-child(2){
            display: inline-block;
            padding-top: 20px;
            font-size: 40px;
            color:#808080;

            transition: all .6s ease;
            position: absolute;
            top:50px
        }
        #edit_second i:nth-child(2)::before{

            background-color: greenyellow;
            line-height: 0px;
            display: block;

        }

        #edit_second i:nth-child(1):hover, #edit_second i:nth-child(2):hover,.item_end i:hover{
            color: white;
            text-shadow: 0 0 5px #fff,
            0 0 10px #fff,
            0 0 20px #228DFF,
            0 0 40px #228DFF;
        }



        .tooltip:hover .tooltiptext {
            visibility: visible;
            text-shadow: 0 0 5px #fff,
            0 0 10px #fff,
            0 0 20px #228DFF,
            0 0 40px #228DFF,
            0 0 60px #228DFF,
            0 0 80px #228DFF;
        }

        .list-item{

            height: 100px;
            width: 750px;

            padding: 20px;
            display: flex;
            margin:20px 0px;
        }
        .list-item:hover{
            background-color: white;

        }
        .content_ul{
            /*height:800px;*/
            max-height: {{page_size / 2 * 180}}px;
            width: 100%;
             word-break: break-word;
            display: flex;
            flex-wrap: wrap;
            flex-direction: column;
      /*      flex-direction:column; !* | row-reverse |  column | column-reverse;*!*/

        }
        .list-item{
/*clear: both;*/
        }
       .video-detail>h4{
           height: 24%;
           overflow: hidden;
           margin-bottom: 2%;
       }

        .video-detail > p{
            height: 34%;
            margin: 2px;
        }

#insert i{
    width: 25px;
    height: 25px;
    border-radius: 50%;
    color: white;
    border:3px solid #006D88;
    text-shadow: 0 0 5px #fff,
    0 0 10px #fff,
    0 0 20px #228DFF,
    0 0 40px #228DFF;
    text-align: center;
    background-color: black;
    position: absolute;
    left: 46%;
    top: -33%;
    z-index: 1;
    font-size: 25px;
    transition: all .3s ease;
}
.video-detail div{
    height: 20%;
    overflow: hidden;
}
.edit h1{
    color: cornflowerblue;
    font-weight: normal;
}
        #insert:hover{
            text-shadow: 0 0 5px #fff,
            0 0 10px #fff,
            0 0 20px #228DFF,
            0 0 40px #228DFF,
            0 0 60px #228DFF,
            0 0 80px #228DFF;
            text-align: center;

        }
        .content_ul li:nth-child(odd){
            margin-right: 1.2%;
        }

        .item_end i:nth-child(3){
            position: absolute;
            bottom: -13px;
            right: 80px;
            font-size: 20px;
        }
    </style>
    <title>{{playlist_title}} - PatchyVideo</title>
</head>

<body>
    <meta id="page" content="{{page}}">
    </meta>
    <meta id="query" content="{{query}}">
    </meta>
    <meta id="page-size" content="{{page_size}}">
    </meta>
    <meta id="page-count" content="{{page_count}}">
    </meta>
    <meta id="order" content="{{order}}">
    </meta>
    <meta id="playlist-id" content="{{playlist_id}}">
    </meta>
    <div class="top-navbar w " id="top-navbar">
        <div class="nav_left">
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/lists">Playlists</a></li>
                <li><a href="/postvideo">Post Video</a></li>
                <li><a href="/edittag">Tags</a></li>
            </ul>
        </div>
        <div class="nav_right">
            <ul>
                {% include "searchbar_new.html" %}
                {% if _user is none %}
                <li><a href="/login">Login</a></li>
                <li><a href="/signup">Sign up</a></li>
                {% else %}
                <li><a style="overflow: hidden; width: 130px;" href="/users/{{_user['_id']}}">{{_user['profile']['username']}}</a></li>
                <li><a href="/logout">Log out</a></li>
                {% endif %}
            </ul>
        </div>
    </div>
    <div class="w">
        <div class="content">

            <div class="deemo shadow">
                <div class="d_t">
                    <h2>{{playlist_title}}</h2>
                    {% if playlist_editable %}
                    <div style="text-align: center">
                        <span><a class="operation" href="/list/{{playlist_id}}/add">[Add video]</a></span>
                        <span><a class="operation" href="/list/{{playlist_id}}/edit">[Edit]</a></span>
                        <span><a id="edit_tags" class="operation" href="#">[Edit Common Tags]</a></span>
                        <span><a class="operation" href="/list/{{playlist_id}}/del">[Delete]</a></span>
                    </div>
                    {% endif %}
                    <a href=""><img src="/images/covers/{{playlist_cover_image}}" width="320px" height="200px" alt="" title=""></a>
                    <p style="white-space: pre-wrap;">{{playlist_desc}}</p>
                </div>
            </div>
            <ul class="content_ul">
                {% for vid in videos %}
                <li class="list-item shadow">
                    <div class="edit">
                        <h1 id="edit_first">{{vid.rank + 1}}</h1>
                        <span id="edit_second">

								{% if playlist_editable %}
                            <span class="tooltip">
                            <a class="operation" href="javascript:moveUp('{{vid._id}}');">
                              <i class="fa fa-arrow-up" aria-hidden="true"></i>
                            </a>
                            <span class="tooltiptext">Move Video Up</span>
                           </span>

     <span class="tooltip">
                             <a class="operation" href="javascript:moveDown('{{vid._id}}');">
                                     <i class="fa fa-arrow-down" aria-hidden="true"></i>
                            </a>
                         <span class="tooltiptext">Move Video Down</span>
						   </span>
						   {% endif %}
                        </span>


                        <!--      <span>
                        <h3 style="display: inline">{{vid.rank + 1}}</h3>
                        </span>-->
              <!--          {% if playlist_editable %}

                        <span class="tooltip">
                            <a class="operation" href="/list/{{playlist_id}}/insert?rank={{vid.rank}}">
                                <i class="fa fa-plus" aria-hidden="true"></i>
                            </a>
                            <span class="tooltiptext">Insert Video Here</span>
                        </span>
                        <span class="tooltip">
                            <a class="operation" href="javascript:deleteVideo('{{vid._id}}');">
                                <i class="fa fa-times" aria-hidden="true"></i>
                            </a>
                            <span class="tooltiptext">Delete This Video</span>
                        </span>
                        <span class="tooltip">
                            <a class="operation" href="javascript:setCover('{{vid._id}}');">
                                <i class="fa fa-picture-o" aria-hidden="true"></i>
                            </a>
                            <span class="tooltiptext">Set Video Cover as Playlist Cover</span>
                        </span>
                        {% endif %}-->
					</div>
                    <div class="item_content">
							{% if playlist_editable %}
                        <div id="insert">
                                 <span class="tooltip">
                            <a class="operation" href="/list/{{playlist_id}}/insert?rank={{vid.rank}}">
                                 <i class="fa fa fa-plus" aria-hidden="true"></i>
                            </a>
                            <span class="tooltiptext">Insert Video Here</span>

						</div>
						{% endif %}
                  <div class="video-thumbnail">
                      {% if vid.item.cover_image|length == 0 %}
                      <img src="/proxy?url={{vid.item.thumbnail_url}}&amp;header=%7B%22User-Agent%22:%22Mozilla/5.0%20(X11;%20Ubuntu;%20Linu%E2%80%A6)%20Gecko/20100101%20Firefox/65.0%22%7D"
                           width="160px" height="100px">
                      {% else %}
                      <img src="/images/covers/{{vid.item.cover_image}}" width="160px" height="100px">
                      {% endif %}
                  </div>
                  <div class="video-detail">
                      <h4><a href="/video?id={{vid._id}}">{{vid.item.title}}</a></h4>
                      <p>{{vid.item.desc}}</p>
                      <div style="overflow: hidden; white-space: nowrap; width: 370px;">
                          <img src="{{ url_for('static',filename='img/' + vid.item.site + '.ico') }}" width="16px"></img>
                          <a href="{{vid.item.url}}" id="link_{{vid._id}}">{{vid.item.url}}</a>
                      </div>
                      <style>
                          .fa-copy:hover {
                              color:olive;
                          }
                      </style>
                  </div>
              </div>

                    <div class="item_end">

							
   						<span class="tooltip" style="{% if not playlist_editable %}display: none;{% endif %}">
                            <a class="operation" href="javascript:setCover('{{vid._id}}');">
                                    <i class="fa fa-picture-o" aria-hidden="true"></i>
                            </a>
                            <span class="tooltiptext">Set Video Cover as Playlist Cover</span>
                        </span>



                        <span class="tooltip"  style="{% if not playlist_editable %}display: none;{% endif %}">
                            <a class="operation" href="javascript:deleteVideo('{{vid._id}}');">
                            <i class="fa fa-times" aria-hidden="true"></i>
                            </a>
                            <span class="tooltiptext">Delete This Video</span>
						</span>
						

                        <i onclick="javascript:copyToClipboard($('#link_{{vid._id}}'));" class="fa fa-copy fa-lg"></i>
                    </div>

                </li>
                {% endfor %}
            </ul>
            <p class="page-selector">{{page_selector_text|safe}}</p>
            <div id="tag">
                <i class="fa fa-close fa-2x" id="close"></i>
                <i class="fa fa-circle-o fa-3x" id="save"></i>
                <div class="minibox">



                    <div class="m_bg">

                    </div>
                    <div class="m_a">
                        <ul class="Taglist Copyright">

                        </ul>
                        <ul class="Taglist Language">

                        </ul>
                        <ul class="Taglist Character">

                        </ul>
                        <ul class="Taglist Author">

                        </ul>
                        <ul class="Taglist General">

                        </ul>
                        <ul class="Taglist Meta">

                        </ul>


                    </div>

                    <div class="m_b">

                        <div>

                            <textarea id="ipt"></textarea>
                            <!--<input class="fa fa-plus-square" type="button"value="add">-->
                            <span id="addtag"> <i class="fa fa-plus-square fa-2x"></i></span>

                        </div>


                    </div>
                </div>
                <span class="tag_title">Edit Common Tags</span>
                <span class="tag_title">Tag already exist</span>
                <span class="tag_title">Tag not exist</span>

            </div>
        </div>
    </div>
    <div class="footer w">
        <p> © 2019 www.patchyvideo.com Touhou Project </p>
    </div>


    </div>
    <script>
        $('#ipt').textcomplete([
            {
                id: 'tags',
                match: /\b([\w][\w][\w_\!\-']*(_\([\w'\-_\!]+\)?)?)$/,
                search: function (term, callback) {
                    $.getJSON( "https://patchyvideo.com/autocomplete/?q=" + term, function( data ) {
                        data = $.map(data, function(ele) {
                            ele['term'] = term;
                            ele['color'] = getCategoryColor(ele['category']);
                            return ele;
                        });
                        callback(data);
                    });
                },
                template: function (value) {
                    suffix = value.src.substring(value.term.length);
                    highlighted_term = `<b>${value.term}</b>${suffix}`;
                    if (isEmpty(value.dst)) {
                        return `<span style="color: ${value.color};"><span style="margin-right: 6em;">${highlighted_term}</span></span><span style="float:right;">${value.count}</span>`;
                    } else {
                        return `<span style="color: ${value.color};"><span>${highlighted_term}</span>-><span style="margin-right: 6em;">${value.dst}</span></span><span style="float:right;">${value.count}</span>`;
                    }
                },
                replace: function (value) {
                    if (isEmpty(value.dst)) {
                        return value.src + '\n';
                    } else {
                        return value.dst + '\n';
                    }
                },
                index: 1
            }
        ],
        {
            onKeydown: function (e, commands) {
                if (e.ctrlKey && e.keyCode === 74) { // CTRL-J
                    return commands.KEY_ENTER;
                }
            }
        });
    </script>
    <script>

        $(function () {
            var input = $("<input>");
            $('.tag_title:last').stop().animate({ opacity: 0 });
            $('.tag_title:eq(1)').stop().animate({ opacity: 0 });

            function getAjaxValue(tagsSet) {
                var s = 0;
                $.ajax({
                    type: "POST",
                    url: "/tags/query_tag_categories.do",
                    async: false,
                    contentType: 'application/json',
                    data: JSON.stringify({ "tags": Array.from(tagsSet) }),
                    success: function (result) {
                        s = result.data.categorie_map;
                    },

                });
                return s;
            };

            function getCommonTags() {
                var s = 0;
                $.ajax({
                    type: "POST",
                    url: "/list/getcommontags.do",
                    async: false,
                    contentType: 'application/json',
                    data: JSON.stringify({ "pid": $("#playlist-id").attr("content") }),
                    success: function (result) {
                        s = result.data;
                    },
                });
                return s;
            }


            function addCommonTags(tags) {
                let v = getAjaxValue(tags);
                for (var i in v) {
                    if ($(`.${v[i]}`).children('div').length == 0) {
                        $(`.${v[i]}`).append(`<div>${v[i]}：</div><li class="item"><p class="val_${i}">${i}</p><i class="fa fa-close"></i></li>`);
                    }
                    else if ($(`.${v[i]}`).find(`.val_${i}`).length == 0 && $(`.${v[i]}`).length != 0) {
                        $(`.${v[i]}`).append(`<li class="item"><p class="val_${i}">${i}</p><i class="fa fa-close"></i></li>`);
                    }
                    else {
                    }

                }
            }
            
            function clearTags() {
                let uls = $('.Taglist');
                for (var i = 0; i != uls.length; ++i) {
                    while (uls[i].hasChildNodes()) {
                        uls[i].removeChild(uls[i].lastChild);
                    }
                }
            }

            function ifval() {
                let inputSet = new Set(input.val().split(/[\s,]/));
                let v = getAjaxValue(inputSet);
                if (JSON.stringify(v) != '{}') {
                    input.parent().html(input.val());
                }

                if (input.val() == '') {
                    if ($("input").parents('.item').siblings('.item').length == 0) {
                        input.parent().parent().parent().children().remove();
                    }
                    else {
                        input.parent().parent().remove();
                    }
                }
            }
            /*$('html').on('dblclick', function () {

                ifval();
            })*/
            $('#edit_tags').on('click', function () {
                clearTags();
                let tags = getCommonTags();
                addCommonTags(tags);
                $('#tag').stop().fadeIn('slow').animate({
                }, function () {
                    $('.minibox').fadeIn('slow');

                });

            });
            $('#ipt').mouseenter(function () {
                $('.tag_title').stop().animate({ opacity: 0 });
            })
            $('.m_b').on('click', '#addtag', function (event) {
                let tagsSet = new Set($('#ipt').val().split(/[\s,]/));
                let v = getAjaxValue(tagsSet);
                let validTags = new Set(Object.keys(v));
                let invalidTags = new Set([...tagsSet].filter(x => !validTags.has(x)));

                for (var i in v) {
                    if ($(`.${v[i]}`).children('div').length == 0) { //当第一次创建分类区域，
                        /*
                                        $('.m_a').append($('<ul class="Taglist">').addClass(`${v[i]}`).append(`<div>${v[i]}：</div><li class="item"><p class="val_${i}">${i}</p><i class="fa fa-close"></i></li>`));
                        */
                        $(`.${v[i]}`).append(`<div>${v[i]}：</div><li class="item"><p class="val_${i}">${i}</p><i class="fa fa-close"></i></li>`);
                    }

                    else if ($(`.${v[i]}`).find(`.val_${i}`).length == 0 && $(`.${v[i]}`).length != 0) { //当分类区域已创建，tag不存在时
                        $(`.${v[i]}`).append(`<li class="item"><p class="val_${i}">${i}</p><i class="fa fa-close"></i></li>`);
                    }
                    else {
                        $('.tag_title:eq(1)').stop().animate({ opacity: 1 }, 1000, function () {
                            $(this).animate({ opacity: 0 }, 3000)
                        });
                        invalidTags.delete(i);
                    }

                }

                $("#ipt").val(Array.from(invalidTags).join('\n'));

                if (Array.from(invalidTags).length != 0) {

                    $('.tag_title:last').stop().animate({ opacity: 1 }, 1000, function () {
                        $(this).animate({ opacity: 0 }, 3000)
                    });
                }
                $('.tag_title:first').fadeOut(1000);

                event.stopPropagation();
            });

            $('.minibox').on('click', '.fa', function () {
                let ulobj = $(this).parents('ul');
                let itemlength = $(this).parents('.item').siblings('.item').length;


                if (itemlength == 0) {
                    ulobj.children().remove();
                } else {
                    $($(this)[0].parentNode).remove();
                }

            })
            /*$('.fa').on('click',function () {
    
            });*/

            /*
            $('.m_a').on('click ', 'p', function () {
                var li = $(this);
                var text = $(this).text();
                li.html("");
                input.attr("value", text);
                input.keyup(function (event) {
                    var myEvent = event || window.event;
                    var kcode = myEvent.keyCode;
                    if (kcode == 13) {
                        ifval();
                    }
                });
                li.append(input);
                //让文本框里边的文章被高亮选中将jquery的对象转换成dom对象
                var inpuliom = input.get(0);
                inpuliom.select();
            });
            */

            $('#tag').on('click', '#close', function () {
                $('.minibox').hide();
                $('#tag').animate({

                }, function () {
                    $(this).fadeOut('linear')
                });
            });

            $('#save').click(function () {
                var tags = [];
                for(let i = 0; i != $('.m_a ul').length; ++i){
                    let key = $($('.m_a ul')[i]).children('div').text();
                    let items = $($('.m_a ul')[i]).children('li.item');
                    for (let j = 0; j != items.length; ++j) {
                        let value = items[j].innerText;
                        if (key != ''){
                            tags.push(value);
                        }
                    }
                }
                postJSON("/list/setcommontags.do",{
                    "pid": $("#playlist-id").attr("content"),
                    "tags": tags
                }, function(result){
                    ;
                });
                $('.minibox').hide();
                $('#tag').animate({}, function () {
                    $(this).fadeOut('linear')
                });
            })


        })
    </script>

</body>

</html>